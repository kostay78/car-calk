import streamlit as st

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(page_title="EV Calc 2026", page_icon="‚ö°", layout="centered")

st.title("‚ö° –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—è")
st.write("–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è —Å –î–í–° –∏ –≠–î (–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, 2026 –≥.)")

# –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
FUEL_PRICES = {"–ê–ò-92": 65.80, "–ê–ò-95": 71.50, "–î–∏–∑–µ–ª—å": 68.20}
ELECTRO_PRICE = 3.85 # –ù–æ—á–Ω–æ–π —Ç–∞—Ä–∏—Ñ

# --- –ë–õ–û–ö –í–í–û–î–ê –î–ê–ù–ù–´–• ---
st.header("1. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")

col1, col2 = st.columns(2)

with col1:
    st.subheader("üöó –ê–≤—Ç–æ–º–æ–±–∏–ª—å —Å –î–í–°")
    price_ice = st.number_input("–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (—Ä—É–±)", value=2200000, step=50000)
    fuel_type = st.selectbox("–¢–∏–ø —Ç–æ–ø–ª–∏–≤–∞", list(FUEL_PRICES.keys()))
    cons_ice = st.number_input("–†–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞ (–ª/100 –∫–º)", value=8.5, step=0.5)

with col2:
    st.subheader("üîã –≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—å (–≠–î)")
    price_ev = st.number_input("–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (–≠–î, —Ä—É–±)", value=3600000, step=50000)
    cons_ev = st.number_input("–†–∞—Å—Ö–æ–¥ —ç–Ω–µ—Ä–≥–∏–∏ (–∫–í—Ç*—á/100 –∫–º)", value=18.0, step=1.0)

st.divider()

st.subheader("üìÖ –£—Å–ª–æ–≤–∏—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏")
annual_km = st.slider("–í–∞—à –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–π –ø—Ä–æ–±–µ–≥ –∑–∞ –≥–æ–¥ (–∫–º)", 5000, 100000, 20000, step=1000)

# --- –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê ---
fuel_price = FUEL_PRICES[fuel_type]

# –°—Ç–æ–∏–º–æ—Å—Ç—å 1 –∫–º –ø—É—Ç–∏
cost_1km_ice = (cons_ice / 100) * fuel_price
cost_1km_ev = (cons_ev / 100) * ELECTRO_PRICE

annual_saving = (cost_1km_ice - cost_1km_ev) * annual_km
price_diff = price_ev - price_ice

# --- –í–´–í–û–î –†–ï–ó–£–õ–¨–¢–ê–¢–û–í ---
st.header("2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞")

if st.button("–†–ê–°–°–ß–ò–¢–ê–¢–¨", type="primary"):
    if price_diff <= 0:
        st.success("‚úÖ –≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—å —Å—Ç–æ–∏—Ç –¥–µ—à–µ–≤–ª–µ –∏–ª–∏ —Å—Ç–æ–ª—å–∫–æ –∂–µ. –í—ã–≥–æ–¥–∞ —Å –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è!")
    elif annual_saving <= 0:
        st.error("‚ö†Ô∏è –≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—å –Ω–µ –æ–∫—É–ø–∏—Ç—Å—è: –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –∑–∞—Ä—è–¥–∫—É –≤—ã—à–µ, —á–µ–º –Ω–∞ —Ç–æ–ø–ª–∏–≤–æ.")
    else:
        payback_years = price_diff / annual_saving
        
        # –ö—Ä–∞—Å–∏–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å —Ü–∏—Ñ—Ä–∞–º–∏
        c1, c2, c3 = st.columns(3)
        c1.metric("–≠–∫–æ–Ω–æ–º–∏—è –≤ –≥–æ–¥", f"{round(annual_saving):,} —Ä—É–±.".replace(",", " "))
        c2.metric("–ü–µ—Ä–µ–ø–ª–∞—Ç–∞ –∑–∞ –≠–î", f"{round(price_diff):,} —Ä—É–±.".replace(",", " "))
        c3.metric("–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏", f"{round(payback_years, 1)} –ª–µ—Ç")
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∏–ª–∏ –ø–æ—è—Å–Ω–µ–Ω–∏–µ
        if payback_years <= 5:
            st.info("üí° –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å. –≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—å –æ–∫—É–ø–∏—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ.")
        else:
            st.warning("üßê –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–∞–µ—Ç 5 –ª–µ—Ç. –ü–æ–∫—É–ø–∫–∞ –≤—ã–≥–æ–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–±–µ–≥–∞—Ö.")

st.sidebar.markdown(f"""
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∞—Ä–∏—Ñ–æ–≤ (2026):
* –ê–ò-92: {FUEL_PRICES['–ê–ò-92']} —Ä—É–±.
* –ê–ò-95: {FUEL_PRICES['–ê–ò-95']} —Ä—É–±.
* –î–∏–∑–µ–ª—å: {FUEL_PRICES['–î–∏–∑–µ–ª—å']} —Ä—É–±.
* –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ: {ELECTRO_PRICE} —Ä—É–±.

""")
